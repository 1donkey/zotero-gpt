Second Simulation of the Satellite Signal in the Solar Spectrum, 6S: An Overview Eric F. Vermote, Member, IEEE, Didier Tanr ÃÅ e, Jean Luc Deuz ÃÅ e, Maurice Herman, and Jean-Jacques Morcrette Abstract‚ÄîRemote sensing from satellite or airborne platforms of land or sea surfaces in the visible and near infrared is strongly affected by the presence of the atmosphere along the path from Sun to Target (surface) to Sensor. This paper presents 6S (Second Simulation of the Satellite Signal in the Solar Spectrum), a computer code which can accurately simulate the above problems. The 6S code is an improved version of 5S (Simulation of the Satellite Signal in the Solar Spectrum), developed by the Laboratoire d‚ÄôOptique Atmospherique ten years ago. The new version now permits calculations of near-nadir (down-looking) aircraft observations, accounting for target elevation, non lambertian surface conditions, and new absorbing species (CH4, N 2O, CO). The computational accuracy for Rayleigh and aerosol scattering effects has been improved by the use of state-of-theart approximations and implementation of the successive order of scattering (SOS) algorithm. The step size (resolution) used for spectral integration has been improved to 2.5 nm. The goal of this paper is not to provide a complete description of the methods used as that information is detailed in the 6S manual, but rather to illustrate the impact of the improvements between 5S and 6S by examining some typical remote sensing situations. Nevertheless, the 6S code has still limitations. It cannot handle spherical atmosphere and as a result, it cannot be used for limb observations. In addition, the decoupling we are using for absorption and scattering effects does not allow to use the code in presence of strong absorption bands. I. INTRODUCTION T HE 5S CODE enables to simulate the signal observed by a satellite sensor for a lambertian target at sea level altitude. An effort has been done to refine the field of application and the accuracy of the code. After a section presenting background materials on the modeling of the remote sensing signal (Section II), the main section describe the modifications done to 5S improve the accuracy and capability of the code (Section III). A specific sub-section is devoted to the inclusion of BRDF (Bidirectional Reflectance Distribution Function) as well as the problem of variable altitude for both sensor and target. In a last part, Section IV, we present the new possibilities for simulation available with the 6S database with a special emphasis on the surface BRDF models, we also give some illustration of the application of atmospheric correction to airborne data. Manuscript received June 6, 1995; revised November 15, 1996. E. F. Vermote was with the Laboratoire d‚ÄôOptique Atmosph ÃÅ erique, University of Lille, France. He is now with the Department of Geography, University of Maryland, College Park, MD 20742 USA. D. Tanr ÃÅ e, J. L. Deuz ÃÅ e, and M. Herman are with the Laboratoire d‚ÄôOptique Atmospherique, University of Lille, France. J.-J. Morcrette is with the European Center for Medium Range Weather Forecast, Reading, U.K. Publisher Item Identifier S 0196-2892(97)03464-5. II. BACKGROUND Two atmospheric processes modify the solar radiance reflected by a target when viewed from space: absorption by the gases (when observation band are overlapping gaseous absorption bands) and scattering by the aerosols and the molecules. If the gaseous absorption can be de-coupled from scattering as if the absorbants were located above the scattering layers, as assumed in the 5S code, the equation of transfer for a lambertian homogeneous target of reflectance at sea level altitude viewed by a satellite sensor (under zenith angle of view azimuth angle of view ) and illuminated by sun ( , ) is (see [1] for a complete description) (1) The various quantities are expressed in terms of equivalent reflectance defined as where is the measured radiance, is the solar flux at the top of the atmosphere, and where is the solar zenith angle. In (1), corresponds to the intrinsic reflectance of the molecule+aerosol layer, , [respectively ] to the total transmission of the atmosphere on the path between the sun and the surface, (respectively between the surface and the sensor). is the spherical albedo of the atmosphere i.e., the normalized irradiance backscattered by the atmosphere when the input irradiance at the bottom is isotropic. is the gaseous transmission, for the solar radiation H O, CO ,O, and O are the principal absorbing gases. The transmission is a nonlinear function of the effective amount of absorptive matters in the atmosphere, and depends also on pressure and temperature profile. In 5S this term is computed by a band absorption model. The 5S code was written ten years ago and the computer resources at this time did not allow the use of accurate methods for solving the equation of transfer due to the large computation burden involved. The reflectances and transmissions were computed using linear single scattering approximation for molecules and the Sobolev approximation for aerosol multiple scattering. For molecules, the linear single scattering approximation is problematic when Rayleigh optical depth or view and solar zenith angle become large. Typically at wavelength shorter than 0.55 m and for view/solar zenith angles greater than 30 the error can reach several time [reflectance units]. This is problematic when looking at dark dense vegetated or oceanic surfaces where the target re0196‚Äì2892/97$10.00 Ô£© 1997 IEE

676 IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 35, NO. 3, MAY 1997 Fig. 1. Contribution of multiple scattering to the intrinsic aerosol reflectance as a function of the view zenith angle for several aerosol optical depth in case of a continental aerosol model for AVHRR channel 1. Computations are performed for two relative azimuths ( = 0 for v < 0,  = 180 for  v > 0). flectance is of the order or [reflectance units]. In addition, the intrinsic atmospheric reflectance observed over black target, was written in 5S as , the sum of aerosols and Rayleigh contributions which is not fully valid at short wavelengths of the solar spectrum ( m) and/or large sun and view zenith angles [2]. For aerosol, the contribution of multiple scattering can reach rapidly half of the total aerosol contribution (Fig. 1) and therefore an accurate method for the computation of multiple scattering contribution is essential. The molecular scattering properties, its phase function, spectral dependence of the optical depth and depolarization factor are well known and stable. Conversely, the aerosol scattering properties are variable. For a given aerosol model, the phase function, extinction and absorption coefficients have to be computed as a function of the wavelength. The optical properties of each individual spherical particle (real and imaginary index) as well as the size distribution of the particles are the parameters used in the Mie computations. In 5S, these computations for the basic aerosol components (soot, oceanic, dust like, water soluble) defined by the International Radiation Commission were performed at a fixed step in radius constrained by the available computing resources. The gaseous transmission is computed in 5S using random exponential band models [3]. These models permit computation of transmission within relatively large spectral bands (20 cm ) suitable for the purpose of simulating the absorption within radiometer bands of several thousands of cm (as used in the Advance Very High Resolution Radiometer bands, AVHRR). However, this may be problematic when trying to simulate the absorption for spectrometers of higher resolution with bands covering only a few hundreds cm . The random exponential band models are computed using AFGL atmospheric absorption line parameters published in 1982 [4]. Also, in the 0.25‚Äì4.0 m range, some gases absorb radiation that are not taken into account in 5S computation, namely Methane (CH ), nitrous oxide (N O), and carbon monoxide (CO). The 6S code is now able to compute the atmospheric transmission due to absorbing gases in the solar reflective spectral range with a good accuracy when scattering effects are neglected. Again, it has limitations when both effects are considered. 5S enables to directly use pre-defined spectral bands for several instruments in flight ten years ago. It also gives the possibility to enter the spectral response with a 5-nm resolution. New instruments have now finer spectral bands and it becomes difficult to enter a representative spectral response at a 5-nm resolution. Moreover the database of 5S instrument spectral responses have to be actualized to reflect sensors currently used. In 5S, the ground target could be uniform or non uniform but has to be lambertian. None of the natural targets are lambertian, but the proper treatment of nonlambertian target needs to compute the coupling of the atmospheric directional downward radiation field with Bi-directional Reflectance Distribution Function (BRDF) of the target that is computationally expensive. Once again, the authors of 5S had to sacrifice the reality versus the practical use of a simulation code. In 5S, in order to simplify the radiative problem the target has to be at sea level and the sensor out of the atmosphere. In order to be closer to real case situation one has to consider the elevation of the target which influences the molecular scattering as well as gaseous absorption. Also, in most cases, field campaign involving airborne prototype instruments requires the possibility to treat within the atmosphere sensor cases. The ‚Äúexact‚Äù solution to the radiative problem is once again not obvious and requires the possibility to compute the vertical distribution of the radiation. The successive order of scattering (SOS) method [5] enables to solve the equation of transfer for in-homogenous atmosphere for a discrete number of atmospheric layer and is an adequate solution to the above mentioned problem. III. RADIATIVE TRANSFER MODELING IN 6S A. Atmospheric Terms 1) Rayleigh: Rayleigh scattering has been extensively studied and the values of the three atmospheric functions , , and (1) have been tabulated by Chandrasekhar [6] among others. Since tables are not convenient, we developed analytical expressions [7] giving a sufficient accuracy. An accuracy of 0.001 (reflectance unit) is achieved for the reflectance, the transmission function is estimated within a relative accuracy better than 0.7% when the differences between the exact computations of the spherical albedo and our expression are around 0.003 for which corresponds to the most unfavorable conditions. 2) Aerosol: In 5S, the scattering properties of the aerosol layer were computed using the Sobolev approximation for the reflectance [8], the Zdunkowski approach [9] for the transmission, and a semi-empirical formula for the spherical albedo. The goal was to provide the user having limited computing resources with a fast approximation. The drawbacks to using these approximations were that the accuracy of the computations could be off by a few time [reflectance units] especially at large view and sun angles or high optical thicknesses. In addition, these approximations could be completely insufficient to handle the integration of the downward radiance field with nonlambertian ground conditions (cf. Fig. 7), a problem in simulating BRDF. Th

VERMOTE et al.: SECOND SIMULATION OF THE SATELLITE SIGNAL 677 Fig. 2. Comparison of 5S, 6S (13 layers, 24 angles) with the Successive Order of scattering computation of the atmospheric intrinsic reflectance for a turbid atmosphere. new scheme used to compute the scattering properties of the aerosol+Rayleigh system relies on the successive order of scattering (SOS) method in its scalar version. The accuracy of such a scheme is better than a few [reflectance units] [10]. It also enables exact simulations of airborne observations. In addition, since the downward radiation field is computed for a quadrature of 13 gaussian emerging angles by 13 azimuths, it will provide the necessary inputs for considering BRDF at the boundary conditions (see Section III-B2). Fig. 2 shows for a turbid atmosphere, i.e., an atmosphere containing aerosol, the comparison between the successive order of scattering method results (with 24 gauss angles and 26 layers) and 6S (using 12 gauss angles and 13 layers) at 550 nm. The difference is negligible but enables to gain a factor 4 in computation time. If the computation time is not a requirement the user can increase the number of layers up to 26 since it is a parameter of the code, then will get a very good accuracy even for optical thickness larger than 0.5. Fig. 2 also shows the results obtained by 5S. Although the accuracy of the molecular intrinsic reflectance is still acceptable at this wavelength, the aerosol contribution is biased by the simplified scheme used in 5S especially in the forward scattering direction. Finally, Fig. 3 shows the difference between the scalar SOS results (which does not take account for polarization as it is done in 6S) versus the vectorial SOS results (taking into account polarization by molecules and aerosols) the error is small compared to the signal observed (less than 1.6% in relative) which justifies the use of the scalar code when molecules and aerosols are mixed. Let us remind that, when rayleigh scattering only is considered, polarization is taken into account through empirically adjusted coefficients. 3) Coupling Scattering-Absorption: For the transmission resulting from gaseous absorption, we do make exact computations, as long as statistical models are considered as exact. Then, for transmissions and reflectances resulting from molecules or aerosols scatterings, we perform accurate computations by the use of the SOS method. When both effects occur simultaneously, we separate them. If it is quite appropriate for ozone, it is not true for water vapor. Fig. 3. Comparison between two versions the Successive Order of scattering computations of the atmospheric intrinsic reflectance, one includes polarization effect and the other just performs scalar computation as it is done in 6S. The atmospheric parameters are the same as for Fig. 2. The coupling between absorption by the water vapor and scattering from the aerosol could be important, because the aerosol and water vapor can be located at the same level in the atmosphere (2‚Äì3 km). The 6S code cannot handle the problem in an exact way since the absorption should be computed along every path after each scattering event. Therefore, we consider three extreme cases in 6S, the water vapor above the aerosol layer [maximum absorption, see (2) for ], the water vapor under the aerosol layer [minimum absorption, see (2) for ], and an average case where we consider that half of the water vapor present in the atmosphere absorbs the aerosol path radiance [see (2) for ]. In that respect, (1) is modified in 6S as: (2) where refers to the gaseous absorption for other gases than water vapor, refers to H O absorption, and is an estimate of the aerosol intrinsic reflectance. Equation (2) is still clearly an approximation since we assume both effects occur separately, but cases 1 and 3 are maximizing/minimizing the effect when case 2 is statistically meaningfull. For each cases, we compute the top of the atmosphere reflectance, so the uncertainty due to the variable vertical distribution of aerosol versus water vapor can be considered. We did not considered in these computation any coupling between molecular scattering and water vapor, because water vapor absorption bands are located mostly at wavelengths where Rayleigh scattering is weak, therefore it results in errors of around 0.001 or less. For others gases, the scheme for decoupling absorption and scattering selected in 5S has been conserved. B. Surface Contribution 1) Nonuniform Target: In case of nonuniform surface, let us first assume that the target is small enough that the photon

678 IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 35, NO. 3, MAY 1997 it reflects are not scattered on the surface-satellite path. Let us note the target reflectance and the reflectance of its surroundings assumed to be uniform. The signal at the top of the atmosphere with no gaseous absorption [11] can be written (3) If the environment is not uniform, (3) is still valid if the reflectance is correctly defined. The definition of has to consider that the weights of the pixels are depending upon their distance to the target. Let us assume that the surface reflectance at a point has polar coordinate ( ). In the simple case of a nadir observation, by defining a function we call in the next the environment function, the reflectance is given by (4) is the probability that a photon which would be directly transmitted to the target with the atmosphere, is in reality scattered and impacts the surface within a circle whose the origin is the target and the radius. By reciprocity, it corresponds also to photons coming from the environment within a circle and reaching the sensor after being scattered. The limit conditions are and . If the target of reflectance is not infinitely small but is a circle of radius surrounded by a uniform background of reflectance ,we define the reflectance of the environment by (5) and (3) simply becomes (6) where the gaseous absorption has been considered above the scattering layer. The function depends upon the molecules and aerosols phase function, their optical thicknesses and vertical distributions. Molecules and aerosols contributions to can be simply separated by the use of (7) with [resp. ] is the upward diffuse transmission function of the molecules (resp. aerosols), and is the total upward diffuse transmission (i.e., the sum of diffuse upward transmission due to molecules and aerosols). In (7) the functions can be computed from a Monte Carlo code by assuming standard vertical distribution of both constituents and a continental aerosol model. For 6S, we look at the dependence of these environment function as a function of the view zenith angle. Fig. 4(a) and (b) shows for several value of the view zenith angle the environment function of Rayleigh (a) (b) Fig. 4. (a) Environment function for a pure molecular atmosphere (lines) for different view zenith angle (v) compared to approximation used in 6S (symbols) as a function of the distance to the imaged pixel (r) and (b) same as (a) but for aerosol. and aerosol. As it can be observed on Fig. 4(a) and (b), there is a dependence of the function on the view direction for view zenith angle larger than 30 . In order to account for this effect, we choose to fit the environment function at the desired view angle solely as a function of the environment function computed for a nadir view as it is suggested by Fig. 4(a) and (b). The results presented on Fig. 4(a) and (b) [symbols] show that a simple polynomial function of nadir view environment function whose coefficients depend on the logarithm of the cosine of view angle is adequate. For molecules, the function is fitted by the simple expression (8a) for aerosol, a polynomial of a higher degree is needed, that is (8b

VERMOTE et al.: SECOND SIMULATION OF THE SATELLITE SIGNAL 679 (a) (b) Fig. 5. (a) Isolines of the pixel background contribution to the signal at the top of the atmosphere for a pure molecular case. The energy source is 104 W and each pixel is considered to have a lambertian reflectance of 1. The contribution of background is the number of Watt coming from each cell (201  201 cells). The plain line are for nadir viewing, the broken line are for a view angle of 70. (b) Same as (a) but for a atmosphere composed exclusively of aerosol particles (Continental model). with , , , and However, it has to be pointed out that if the approximations (8a), (8b) enable to take into account adjacency effect for an arbitrary view angle, they implied uniformity of the background as a function of azimuth. Fig. 5(a) [resp. Fig. 5(b)] presents for molecules (resp. aerosols) isolines of the pixel background contributions considering a energy source of 10 W and a uniform lambertian reflectance of 1 for the whole scene. The contribution of background is the number of Watts coming from each cell (201 201 cells). For molecules in case of a view angle of 70 [Fig. 5(a)] which represents an extreme case, the contribution of the background in the direction of the observer is greater. It results that the isolines which were circles in case of nadir view are now ellipses shifted toward the observer. For aerosols [Fig. 5(b)], the background contributio

680 IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 35, NO. 3, MAY 1997 is less important and the deformation due to the tilted view (70 ) is also less important due to the fact that aerosols forward scattering predominates. One direct conclusion of Fig. 5(a) and (b) is that contributions of the adjacent pixels for a large view angle don‚Äôt comply to the symmetry in azimuth. Therefore, the 6S results, in case of large view angles, have to be interpreted more like a sensitivity test to the problem of adjacency effect rather than an actual way to perform adjacency effect correction. 2) BRDF: In 6S, the coupling between the BRDF (Bidirectional Reflectance Distribution Function) and the downward radiance at the surface level is taken into account according to the scheme presented in Tanre et al. [12]. The contribution of the target to the signal at the top of the atmosphere is decomposed as the sum of four terms: a) the photons directly transmitted from the sun to the target and directly reflected back to the sensor; b) the photons scattered by the atmosphere then reflected by the target and directly transmitted to the sensor; c) the photons directly transmitted to the target but scattered by the atmosphere on their way to the sensor; and finally d) the photons having at least two interactions with the atmosphere and one with the target. One can compute exactly each contributions a)‚Äìd) according to the following set of (9a)‚Äì(9d) as already shown in Tanre et al. [12] by defining (9a) (9b) where is the total downward diffuse transmission (9c) where is the total upward diffuse transmission (9d) In 6S, the first three contributions are computed exactly using the downward radiation field given by the SOS method for several directions, which allows us to perform the integrations in (9b) and (9c). The contribution which involves at least two interaction between the atmosphere and the BRDF (9d) is approximated by taking equal to the hemispherical albedo of the target (9e) This approximation is justified by the limited impact on the total signal of this last contribution, weighted by the product Fig. 6. Comparison of the sum of the coupling terms atmosphere-BRDF: T OA (R+A + e ms) computed by 6S with the same quantity computed by the SOS code for different atmospheric conditions (clear, average, turbid). The ground BRDF is from Kimes measurements over a plowed field fitted with Hapke BRDF model. and , and also by the fact that multiple scattering tends to be isotropic. The form is convenient because the exact computation will require a double integration. Thus, the signal at the top of the atmosphere is written as (without gaseous absorption for clarity purpose only) (10) Therefore, the only approximation in the computing scheme is the estimation of multiple interaction between target and atmosphere. We present Fig. 6 the comparison for a typical BRDF signature, the plowed field measured by Kimes [13], of the 6S results with independent computations performed by decomposing the BRDF in Fourier series and include it as ground boundary condition in an SOS code as done in the model published by Deuz ÃÅ e et al. [14]. We only compare the sum of the four last terms of (10) that involve a coupling between the atmosphere and the surface. As it can be seen the approximation done in the computation of multiple interaction between ground and atmosphere is valid and only brings substantial error (still lower than ) for turbid atmosphere and large view zenith angle. We also presented, Fig. 7, the error done for the plowed field case again, by neglecting any coupling between BRDF and atmosphere and use (1) only valid for a lambertian target to perform atmospheric correction, by assuming the atmospheric properties known. C. Elevated Target Simulation For a target not at sea level, (1)1 is modified as follows: (11) 1 For clarity purposes we illustrate the approach taken in 6S on the basis of (1), even if in the code coupling molecules-aerosol and aerosol-water vapor are taken into account

VERMOTE et al.: SECOND SIMULATION OF THE SATELLITE SIGNAL 681 Fig. 7. Limitations of the lambertian assumption for atmospheric correction [use of (1) instead of (8)] for a gentle atmosphere. In that case, correction using directional information (- - - -) is conducted by fitting the results of the correction using (1) (+) with the Hapke BRDF model and reinjecting the BRDF to compute coupling terms of (9a)‚Äì(9e). The amount of scattering particles above the target (molecules and aerosols) and the amount of gaseous absorbants are related to the target altitude. In the 5S code, the amount and types of aerosol are input parameters, thus the aerosol characteristics implicitly depend on target altitude because they are measured/estimated at target location. In 6S, the target altitude can be an input: after selection of the atmospheric profile, the target altitude is used to compute a new atmospheric profile by stripping out the atmospheric level under target altitude and interpolating if necessary. This way, an exact computation of the atmospheric functions is performed that account for coupled pressure-temperature effect on absorption. The influence of target altitude on has been evaluated for the case of the AVHRR channel 1 (0.500‚Äì0.740 m) [Fig. 8(a)] and channel 2 (0.690‚Äì1.080 m) [Fig. 8(b)]. Because the ozone layer is located in the upper levels of the atmosphere, the O amount is not depending on target altitude and transmission is not affected. Conversely, the target altitude has an important effect on the absorption by H O because most of the water vapor is located in the lower atmosphere. However, the exact sensitivity of the target‚Äôs altitude on water vapor absorption cannot be generalized because the H O amount is directly connected to the water vapor profile which is very variable. We can also notice the small impact on O absorption since there is almost no O absorption lines in these particular bands. The effect of target altitude on molecular optical thickness is exactly accounted for in 6S. Operationally, because it is not very efficient to compute integral of the Rayleigh extinction as function of pressure, one may consider that is proportional to the pressure at target level. Fig. 9 shows that, for a midlatitude summer pressure profile, and for AVHRR channel 1, the difference between exact computations and this approximation is negligible. Fig. 10 illustrates the influence of target‚Äôs altitude, in term of variation of the Rayleigh reflectance (in absolute) for (a) (b) Fig. 8. (a)‚Äì(b): Influence of the altitude of the target on the gaseous transmission function computed in the case of AVHRR channel 1(a) and 2(b). The atmospheric profile is the tropical atmosphere and the view and sun zenith angles are equal to 30. Fig. 9. Influence of the altitude of the target on the molecular optical thickness. A simple valid approximation is to consider that the molecular optical depth is proportional to the barometric pressure as shown. AVHRR channel 1 for the whole globe, using the 1/12 of degree resolution elevation map. For each pixel a 30 off nadir observation map has been computed for solar zenith angle of 30 (back scattering). The Digital Elevation Model used in this simulation is ETOPO5 [15]

682 IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 35, NO. 3, MAY 1997 Fig. 10. Influence of the altitude of target on the molecular intrinsic reflectance, the simulation shows for a typical observation geometry in the backscattering direction (sun zenith = 30, view zenith = 30, relative azimuth = 0). The color code gives the absolute difference in unit of reflectance between the altitude dependent computation and the computation assuming the target is at sea level. The elevation is given by the ETOPO5 model. D. Airborne Sensor Simulation In case of sensor inside the atmosphere (airborne sensor), (1)2 is modified as the following: (12) Gaseous absorption is computed with a technique similar to the one used in the case of a target not at sea level except that it only modify the upward path. Practically, the atmospheric layers above the sensor are stripped from the profile, so the gaseous transmission is integrated till the sensor altitude (interpolation of the atmospheric profile is conducted if necessary). Fig. 11(a) and (b) illustrates the effect of the sensor altitude on gaseous transmission computation, for 30 , 30 . In the particular case presented, that is AVHRR visible and near infrared channels, we must point out that O absorption on the path target-sensor is not depending on the sensor altitude because these molecules are located high in the atmosphere. For H O, the absorption is very dependent of the altitude up to 4 km, due to the fact the water vapor is located is the first 4 km of the atmospheric column. So, if the observed channel is sensitive to water vapor absorption (as it is the case of AVHRR channel 2) we recommend that additional measurements of water vapor are taken from the aircraft (except for stratospheric aircraft). In addition to the option which allows the user to enter his own total atmospheric profile, it is now possible to enter aerosol, ozone, and water 2 The equation is deliberately simplified in order to make the writing easier but in the code all coupling terms are taken into account. vapor content for the portion of the atmosphere located under the plane. 1) Atmospheric Reflectance and Transmission: In 6S, the computation is performed exactly by defining one of the multiple layers used in the SOS at the altitude of the sensor. This enables exact computation of both reflectance and transmission term of a realistic mixing between aerosol and molecules. 2) Nonuniform Target: In case of airborne observation, (6) is modified as follows: (13) where is the optical thickness of the layer under the plane, and is the ‚Äúeffective‚Äù diffuse upward transmission equal to the total transmission computed exactly as described in the previous section minus the modified direct upward transmission . The term is computed as in (5) but instead of using the environment function for the whole atmosphere, a function that takes account for the altitude of the sensor, , has been defined: (14) The diffuse transmission term related to molecules and aerosols scattering effect are computed by the same approach used for computing . To compute the and functions, Monte Carlo have been performed fo

VERMOTE et al.: SECOND SIMULATION OF THE SATELLITE SIGNAL 683 (a) (b) Fig. 11. Variation of the gaseous transmission (Tg) as a function of the observer altitude, z, (airborne case), for AVHRR channel 1(a) and 2(b) spectral responses. The sun zenith angle is 30 and the view zenith angle is 30, Tropical atmosphere was used. different altitudes of the sensor ( km) and included in 6S as a database. In the code, the closest simulated altitudes are used to interpolate the environment function at the input sensor altitude. Fig. 12(a) and (b) illustrates some of the simulations performed. As expected, for both molecules and aerosols, the influence of the environment is decreasing [higher ] when the sensor altitude is decreasing. The respective vertical distribution of molecules (scale height of 8 km) and aerosol (scale height of 4 km) influence the variation of the environment function with the altitude of the sensor. For aerosol the variation of is faster than for the molecules when the sensor altitude varies from 0.5 to 5 km. IV. IMPROVEMENT OF THE 5S DATABASE The spectral resolution of the code has been improved by refining the step of 5 nm used in 5S to 2.5 nm in 6S. Whenever it was possible, the spectral databases have been updated using original data at 2.5-nm resolution or interpolated when the original data were at a coarser resolution. In addition to increase the accuracy of the spectral integration, this improvement provides better handle of the problem of fine spectral bands radiometer or spectrometer for which the 5-nm resolution of 5S was too coarse. 1) Aerosol Models: The radiative properties of the basic components (soot, oceanic, dust like, water soluble) defined (a) (b) Fig. 12. (a) Variation of the molecular environment function, (FR) for different altitude of the sensor. (b) Variation of the aerosol environment function, (FA) for different altitude of the sensor. by the International Radiation Commission [16] have been computed with a finer step in particles radius in 6S than the one used in 5S. In addition, several aerosol models (stratospheric [17], desertic [18], and aerosol resulting from biomass burning [19]) difficult to reproduce using a mixing of basic components are now available for use in 6S. 2) Spectroscopic Data: The computation scheme has not been changed but improvement have been done concerning the resolution and the accuracy of the spectroscopic database. The band absorption parameters of 6S has been computed using the HITRAN database at 10 cm resolution. Important gases in the 0.25‚Äì4.0 m region, namely CH , CO, NO , are now taken into account in the computation of the gaseous transmission. Fig. 13(a)‚Äì(c) shows the comparison between MODTRAN (5 cm resolution) and 6S for the computation of the transmission function in the case of the typical mid-latitude summer atmosphere. For clarity purpose, the spectrum has been divided in three intervals: 0.25‚Äì1.20 m [Fig. 13(a)], 1.20‚Äì2.40 m [Fig. 13(b)], and 2.40‚Äì4.00 m [Fig. 13(c)]. With this new spectral resolution it is now possible to conduct atmospheric correction for small bandwidth sensor, as illustrated by Fig. 14, where Advanced Solid state Array Spectrometer [20] (ASAS) data over the Konza prairie (Kansas) were corrected for atmospheric effect using 6S. For each of the 29 spectral bands, the radiance value measured by the instrument were input in